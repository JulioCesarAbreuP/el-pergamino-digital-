<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lab 20 – Detección de firewalls y técnicas de evasión</title>
  <link rel="icon" href="/el-pergamino-digital/assets/favicon.png" type="image/png" />
  <style>
    :root { color-scheme: dark; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #121212;
      color: #e0e0e0;
      margin: 0;
      padding: 0;
    }
    nav {
      background-color: #1f1f1f;
      padding: 1em;
      text-align: center;
    }
    nav a {
      color: #e0e0e0;
      margin: 0 1em;
      text-decoration: none;
    }
    nav a.activo {
      font-weight: bold;
      text-decoration: underline;
    }
    h1 {
      text-align: center;
      margin-top: 1.5em;
      color: #ffffff;
    }
    .subtitulo {
      text-align: center;
      color: #bbbbbb;
      margin-bottom: 2em;
    }
    main {
      max-width: 900px;
      margin: auto;
      padding: 2em;
    }
    section {
      margin-bottom: 2em;
    }
    h2 {
      color: #90caf9;
    }
    code {
      background-color: #1e1e1e;
      padding: 0.2em 0.4em;
      border-radius: 4px;
      font-family: monospace;
    }
    footer {
      text-align: center;
      padding: 2em;
      background-color: #1e1e1e;
      font-size: 0.9em;
      color: #aaaaaa;
    }
    @media (max-width: 600px) {
      body { font-size: 1.1em; }
      h1 { font-size: 1.8em; }
      .subtitulo { font-size: 1.1em; }
      nav a { display: block; margin: 0.5em 0; }
    }
  </style>
</head>
<body>
  <nav>
    <a href="/el-pergamino-digital/index.html">Inicio</a>
    <a href="/el-pergamino-digital/labs/" class="activo">Laboratorios</a>
    <a href="/el-pergamino-digital/glosario/">Glosario</a>
    <a href="/el-pergamino-digital/simulador/">Simulador</a>
    <a href="/el-pergamino-digital/modulos/">Módulos</a>
  </nav>

  <h1>Lab 20 – Detección de firewalls y técnicas de evasión</h1>
  <p class="subtitulo">Identificación de mecanismos de filtrado y aplicación de técnicas para evadir detección durante el reconocimiento</p>

  <main>
    <section>
      <h2>Objetivo</h2>
      <p>Detectar la presencia de firewalls o sistemas de filtrado en un entorno objetivo y aplicar técnicas de evasión para obtener información sin ser bloqueado o detectado.</p>
    </section>

    <section>
      <h2>Alcance y limitaciones</h2>
      <p><strong>Alcance:</strong> Detección de filtrado de paquetes, análisis de respuestas ICMP/TCP, evasión mediante fragmentación, manipulación de flags y timing.</p>
      <p><strong>Limitaciones:</strong> No se realiza explotación ni bypass de autenticación. El laboratorio se limita a técnicas de evasión pasiva y reconocimiento controlado.</p>
      <p><strong>Escenario sugerido:</strong> Kali Linux escaneando un host protegido por firewall (p. ej. pfSense, iptables, Windows Defender Firewall) en red virtual.</p>
    </section>

    <section>
      <h2>Requisitos previos</h2>
      <ul>
        <li>Conocimientos de TCP/IP, firewalls, filtrado de paquetes y detección de intrusiones</li>
        <li>Familiaridad con Nmap, hping3 y técnicas de evasión</li>
        <li>Entorno: Kali Linux, host objetivo con firewall activo, red virtual controlada</li>
        <li>Herramientas: <code>nmap</code>, <code>hping3</code>, <code>Wireshark</code>, <code>iptables</code> (en el host objetivo)</li>
      </ul>
    </section>

    <section>
      <h2>Arquitectura del entorno</h2>
      <pre>
[ Kali Linux (192.168.1.10) ]
        ↓
[ Firewall (pfSense / iptables) ]
        ↓
[ Host objetivo (192.168.1.20) ]
      </pre>
      <p>El atacante simula técnicas de evasión para detectar y sortear mecanismos de filtrado durante el reconocimiento.</p>
    </section>

    <section>
      <h2>Herramientas y entorno técnico</h2>
      <ul>
        <li><strong>Nmap</strong>: escaneo con técnicas de evasión (<code>-f</code>, <code>--data-length</code>, <code>--ttl</code>, <code>--scan-delay</code>)</li>
        <li><strong>hping3</strong>: manipulación de paquetes TCP/ICMP para detección de filtrado</li>
        <li><strong>Wireshark</strong>: análisis de tráfico y respuestas del firewall</li>
        <li><strong>iptables</strong>: configuración del firewall en el host objetivo (si se desea simular)</li>
      </ul>
    </section>

        <section>
      <h2>Procedimiento técnico paso a paso</h2>
      <ol>
        <li>Detectar filtrado con Nmap:
          <pre><code>nmap -p 80,443,22 --reason 192.168.1.20</code></pre>
          <p>Observar si los puertos aparecen como <code>filtered</code>, <code>closed</code> o <code>open</code></p>
        </li>
        <li>Enviar paquetes ICMP con hping3:
          <pre><code>hping3 -1 192.168.1.20</code></pre>
          <p>Verificar si hay respuesta o bloqueo</p>
        </li>
        <li>Escaneo con fragmentación de paquetes:
          <pre><code>nmap -f -p 80,443 192.168.1.20</code></pre>
        </li>
        <li>Manipular TTL para evadir detección:
          <pre><code>nmap --ttl 5 -p 80,443 192.168.1.20</code></pre>
        </li>
        <li>Agregar relleno aleatorio al paquete:
          <pre><code>nmap --data-length 50 -p 80,443 192.168.1.20</code></pre>
        </li>
        <li>Reducir velocidad para evitar alertas:
          <pre><code>nmap --scan-delay 1s -p 80,443 192.168.1.20</code></pre>
        </li>
        <li>Analizar tráfico con Wireshark para observar respuestas del firewall</li>
      </ol>
    </section>

    <section>
      <h2>Resultados esperados</h2>
      <ul>
        <li>Identificación de puertos filtrados o bloqueados</li>
        <li>Confirmación de presencia de firewall por ausencia de respuestas o comportamiento anómalo</li>
        <li>Detección de técnicas de evasión que logran obtener respuestas</li>
        <li>Comparación entre escaneos normales y modificados</li>
      </ul>
    </section>

    <section>
      <h2>Análisis de resultados</h2>
      <p>Los firewalls pueden bloquear escaneos evidentes, pero técnicas como la fragmentación, manipulación de TTL o ralentización del escaneo pueden evadir ciertas reglas. Analizar las respuestas (o su ausencia) permite inferir la existencia de mecanismos de defensa y ajustar la estrategia de reconocimiento.</p>
    </section>

    <section>
      <h2>Medidas</h2>
      <ul>
        <li>Registrar puertos filtrados y técnicas que lograron respuesta</li>
        <li>Comparar resultados entre escaneos normales y evasivos</li>
        <li>Documentar comportamiento del firewall ante cada técnica</li>
      </ul>
    </section>

    <section>
      <h2>Contramedidas</h2>
      <ul>
        <li>Configurar firewalls para detectar y bloquear escaneos fragmentados o lentos</li>
        <li>Implementar IDS/IPS que analicen patrones de evasión</li>
        <li>Limitar respuestas ICMP y aplicar reglas de filtrado por TTL y tamaño de paquete</li>
        <li>Monitorear logs de firewall para detectar intentos de evasión</li>
      </ul>
    </section>

    <section>
      <h2>Riesgos y advertencias</h2>
      <p>El uso de técnicas de evasión puede activar alertas en sistemas de defensa. Este laboratorio debe realizarse únicamente en entornos controlados y con fines educativos. No aplicar estas técnicas en redes reales sin autorización expresa.</p>
    </section>

    <section>
      <h2>Evidencias</h2>
      <p><em>Espacio reservado para capturas de pantalla de Nmap, hping3, Wireshark y resultados comparativos.</em></p>
    </section>

    <section>
      <h2>Validación cruzada</h2>
      <ul>
        <li><a href="https://attack.mitre.org/techniques/T1595/" target="_blank">MITRE ATT&CK T1595 – Active Scanning</a></li>
        <li><a href="https://attack.mitre.org/techniques/T1562/004/" target="_blank">MITRE ATT&CK T1562.004 – Disable or Modify System Firewall</a></li>
        <li><a href="https://cas.docs.cisecurity.org/en/latest/source/Controls13/" target="_blank">CIS Control 13 – Network Monitoring and Defense</a></li>
      </ul>
    </section>


        <section>
      <h2>Referencias normativas y técnicas</h2>
      <ul>
        <li><a href="https://attack.mitre.org/techniques/T1595/" target="_blank">MITRE ATT&CK T1595 – Active Scanning</a></li>
        <li><a href="https://attack.mitre.org/techniques/T1562/004/" target="_blank">MITRE ATT&CK T1562.004 – Disable or Modify System Firewall</a></li>
        <li><a href="https://cas.docs.cisecurity.org/en/latest/source/Controls13/" target="_blank">CIS Control 13 – Network Monitoring and Defense</a></li>
      </ul>
    </section>

    <section>
      <h2>Certificaciones asociadas</h2>
      <ul>
        <li>CompTIA PenTest+ – Domain 3.0: Attacks and Exploits</li>
        <li>eJPT – Firewall Evasion and Filtering</li>
        <li>OSCP – Bypassing Firewalls and Filters</li>
      </ul>
    </section>

    <section>
      <h2>Analogía técnica</h2>
      <p style="font-family: 'Comic Sans MS'; font-size: 12pt;">
        Evasión de firewalls es como caminar por un campo minado con pasos suaves y calculados: cada movimiento cuenta.
      </p>
    </section>

    <section>
      <h2>Nivel de dificultad</h2>
      <p>Intermedio</p>
    </section>

    <section>
      <h2>Checklist final</h2>
      <ul>
        <li>[ ] Firewall detectado mediante escaneo y análisis de respuestas</li>
        <li>[ ] Técnicas de evasión aplicadas (fragmentación, TTL, data-length)</li>
        <li>[ ] Comparación entre escaneos normales y evasivos</li>
        <li>[ ] Análisis de tráfico con Wireshark documentado</li>
        <li>[ ] Validación cruzada registrada</li>
      </ul>
    </section>

    <section>
      <h2>Navegación transversal</h2>
      <ul>
        <li><a href="/el-pergamino-digital/index.html">Portada</a></li>
        <li><a href="/el-pergamino-digital/glosario/">Glosario</a></li>
        <li><a href="/el-pergamino-digital/simulador/">Simulador</a></li>
        <li><a href="/el-pergamino-digital/modulos/">Módulos</a></li>
        <li><a href="/el-pergamino-digital/labs/">Laboratorios</a></li>
      </ul>
    </section>

    <section>
      <h2>Reflexión estratégica</h2>
      <p>Detectar y evadir firewalls no es un acto de fuerza, sino de inteligencia. Este laboratorio enseña a leer el silencio, a interpretar la ausencia de respuestas como señales, y a adaptar el reconocimiento sin levantar alarmas. Es el arte de avanzar sin ser visto.</p>
    </section>

    <section>
      <h2>Disclaimer de advertencia</h2>
      <p><strong>Advertencia:</strong> Este laboratorio está diseñado exclusivamente para fines educativos y debe ejecutarse en entornos virtuales controlados. El uso de técnicas de evasión en redes reales sin autorización puede constituir una actividad ilegal. El Pergamino Digital no se responsabiliza por el uso indebido de las técnicas aquí descritas.</p>
    </section>
  </main>

  <footer>
    <p>Este laboratorio forma parte del proyecto <a href="https://pergamino-digital-ciberseguridad.blogspot.com/?m=1" target="_blank">El Pergamino Digital</a>, alineado con estándares internacionales y diseñado para fortalecer competencias técnicas en ciberseguridad.</p>
  </footer>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const links = document.querySelectorAll("nav a");
      links.forEach(link => {
        if (link.href === window.location.href) {
          link.classList.add("activo");
        }
      });
    });
  </script>
</body>
</html>
