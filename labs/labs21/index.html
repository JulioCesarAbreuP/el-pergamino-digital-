<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lab 21 ‚Äì Fingerprinting de firewalls y t√©cnicas evasivas</title>
  <link rel="icon" href="/el-pergamino-digital/assets/favicon.png" type="image/png" />
  <link rel="stylesheet" href="/el-pergamino-digital/assets/style.css" />
  <script src="/el-pergamino-digital/assets/script.js"></script>
</head>
<body>

  <h1>Lab 21 ‚Äì Fingerprinting de firewalls y t√©cnicas evasivas</h1>

  <h2>Objetivo</h2>
  <p>Identificar la presencia, tipo y comportamiento de firewalls en una red objetivo mediante t√©cnicas de fingerprinting y evasi√≥n, utilizando herramientas especializadas y analizando las respuestas del sistema filtrante.</p>

  <h2>Alcance y limitaciones</h2>
  <p>Este laboratorio se enfoca en firewalls de red (stateful y stateless) y su respuesta ante paquetes manipulados. No se abordan WAFs ni soluciones de filtrado de capa 7. El entorno es controlado y no debe replicarse en redes de producci√≥n.</p>
  <p>M√°quina vulnerable utilizada: <a href="https://www.vulnhub.com/entry/funbox-rookie,754/" target="_blank">Funbox: Rookie ‚Äì VulnHub</a></p>

  <h2>Requisitos previos</h2>
  <ul>
    <li>Conocimientos b√°sicos de TCP/IP, firewalls y t√©cnicas de escaneo.</li>
    <li>Herramientas: <code>nmap</code> (v7.94), <code>hping3</code> (v3.20051105), <code>firewalk</code> (v5.0).</li>
    <li>Entorno virtualizado con al menos 2 GB de RAM por m√°quina, red en modo NAT o red interna.</li>
  </ul>

  <h2>Arquitectura del entorno</h2>
  <p>El entorno consta de tres nodos:</p>
  <ul>
    <li><strong>Atacante:</strong> Kali Linux ‚Äì IP: 192.168.56.10</li>
    <li><strong>Firewall:</strong> pfSense ‚Äì IP WAN: 192.168.56.1 / IP LAN: 10.0.0.1</li>
    <li><strong>Objetivo:</strong> M√°quina vulnerable ‚Äì IP: 10.0.0.5</li>
  </ul>
  <p>La segmentaci√≥n de red permite observar el comportamiento del firewall ante distintos tipos de tr√°fico.</p>

  <h2>Herramientas y entorno t√©cnico</h2>
  <ul>
    <li><strong>Sistemas operativos:</strong> Kali Linux, pfSense, Ubuntu Server vulnerable.</li>
    <li><strong>Herramientas:</strong> <code>nmap</code>, <code>hping3</code>, <code>firewalk</code>, <code>tcpdump</code>.</li>
    <li><strong>Servicios:</strong> SSH, HTTP, FTP, configurados con reglas de firewall espec√≠ficas.</li>
  </ul>

    <h2>Procedimiento t√©cnico paso a paso</h2>

  <h3>Fingerprinting con Nmap</h3>
  <pre><code>nmap -sS -p 22,80,443 10.0.0.5 -Pn -v</code></pre>
  <p>Se realiza un escaneo SYN para detectar puertos filtrados o abiertos. Se observa si hay respuestas RST o ausencia de respuesta (indicador de filtrado).</p>

  <h3>Detecci√≥n de filtrado con Firewalk</h3>
  <pre><code>firewalk -S 192.168.56.10 -D 10.0.0.5 -p 80 -r 1 -n</code></pre>
  <p>Se analiza si el firewall permite o bloquea paquetes con TTL manipulados. Firewalk infiere reglas de filtrado bas√°ndose en el TTL de respuesta.</p>

  <h3>Simulaci√≥n de evasi√≥n con Hping3</h3>
  <pre><code>hping3 -S -p 80 -c 3 -flood -a 1.2.3.4 10.0.0.5</code></pre>
  <p>Se env√≠an paquetes con spoofing de IP para evaluar si el firewall permite tr√°fico sin validaci√≥n de origen.</p>

  <h3>Captura de tr√°fico con Tcpdump</h3>
  <pre><code>tcpdump -i eth0 host 10.0.0.5</code></pre>
  <p>Se monitorean respuestas del objetivo y comportamiento del firewall ante los paquetes enviados.</p>

  <h2>Resultados esperados</h2>
  <ul>
    <li>Puertos filtrados no responden (sin SYN/ACK ni RST).</li>
    <li>Firewalk muestra saltos permitidos y bloqueados.</li>
    <li>Hping3 puede ser bloqueado si hay reglas anti-spoofing.</li>
    <li>Tcpdump muestra paquetes descartados o aceptados por el firewall.</li>
  </ul>

  <h2>An√°lisis de resultados</h2>
  <p>La ausencia de respuesta en puertos espec√≠ficos indica filtrado. Si Firewalk detecta un salto bloqueado, se confirma la presencia de un firewall. Si Hping3 logra pasar tr√°fico spoofeado, se evidencia una mala configuraci√≥n de reglas.</p>

  <h2>Medidas</h2>
  <ul>
    <li>Reforzar reglas de firewall para bloquear paquetes con IPs spoofeadas.</li>
    <li>Limitar respuestas ICMP innecesarias.</li>
    <li>Aplicar pol√≠ticas de <em>default deny</em> y permitir solo tr√°fico expl√≠citamente autorizado.</li>
  </ul>

  <h2>Contramedidas</h2>
  <ul>
    <li>Implementar detecci√≥n de escaneos con IDS (Snort, Suricata).</li>
    <li>Habilitar logging de paquetes descartados para an√°lisis posterior.</li>
    <li>Aplicar reglas de filtrado por estado de conexi√≥n (stateful inspection).</li>
  </ul>

  <h2>Riesgos y advertencias</h2>
  <p>El uso de herramientas como Hping3 puede generar tr√°fico sospechoso. Ejecutar solo en entornos controlados. Firewalk puede generar falsos positivos si hay p√©rdida de paquetes. No ejecutar en redes reales sin autorizaci√≥n.</p>

  <h2>Evidencias</h2>
  <p>üì∏ Espacio reservado para capturas de pantalla de Nmap, Firewalk, Hping3 y Tcpdump.</p>

    <h2>Validaci√≥n cruzada (CIS, NIST, MITRE)</h2>
  <ul>
    <li><a href="https://www.cisecurity.org/controls/secure-network-engineering" target="_blank">CIS Control 13 ‚Äì Network Monitoring and Defense</a></li>
    <li><a href="https://csrc.nist.gov/publications/detail/sp/800-115/final" target="_blank">NIST SP 800-115 ‚Äì Technical Guide to Information Security Testing</a></li>
    <li><a href="https://attack.mitre.org/techniques/T1046/" target="_blank">MITRE ATT&CK T1046 ‚Äì Network Service Scanning</a></li>
  </ul>

  <h2>Referencias normativas y t√©cnicas</h2>
  <ul>
    <li><a href="https://nmap.org/book/man-port-scanning-techniques.html" target="_blank">Nmap ‚Äì Port Scanning Techniques</a></li>
    <li><a href="https://linux.die.net/man/8/hping3" target="_blank">Hping3 ‚Äì Linux Man Page</a></li>
    <li><a href="https://packetstormsecurity.com/files/author/1125/" target="_blank">Firewalk ‚Äì Packet Storm</a></li>
  </ul>

  <h2>Certificaciones asociadas</h2>
  <ul>
    <li>CompTIA Security+ (Objetivo 2.4 ‚Äì Seguridad de red)</li>
    <li>CEH ‚Äì Certified Ethical Hacker (M√≥dulo: Scanning Networks)</li>
    <li>ISC2 CC ‚Äì Fundamentos de seguridad de red</li>
  </ul>

  <h2>Analog√≠a t√©cnica</h2>
  <p>Un firewall es como un centinela en la muralla de un castillo: no solo decide qui√©n entra, sino que tambi√©n observa c√≥mo se comportan los visitantes. El fingerprinting es como enviar mensajeros disfrazados para ver si el centinela reacciona, y la evasi√≥n es como intentar colarse con una capa de invisibilidad.</p>

  <h2>Nivel de dificultad</h2>
  <p>Intermedio</p>

  <h2>Checklist final</h2>
  <ul>
    <li>‚úÖ Se configur√≥ el entorno con firewall y m√°quina vulnerable</li>
    <li>‚úÖ Se ejecutaron pruebas con Nmap, Firewalk y Hping3</li>
    <li>‚úÖ Se capturaron evidencias con Tcpdump</li>
    <li>‚úÖ Se documentaron resultados, an√°lisis y contramedidas</li>
    <li>‚úÖ Se incluyeron validaciones cruzadas y referencias activas</li>
  </ul>

  <h2>Navegaci√≥n transversal</h2>
  <ul>
    <li><a href="/el-pergamino-digital/index.html">üè† Portada del proyecto</a></li>
    <li><a href="/el-pergamino-digital/glosario.html">üìò Glosario t√©cnico-afor√≠stico</a></li>
    <li><a href="/el-pergamino-digital/simulador.html">üß™ Simulador certificador</a></li>
    <li><a href="/el-pergamino-digital/labs/index.html">üß≠ √çndice de laboratorios</a></li>
  </ul>

  <h2>Reflexi√≥n estrat√©gica</h2>
  <p>Comprender c√≥mo se comporta un firewall ante distintos tipos de tr√°fico no solo permite evaluar su robustez, sino tambi√©n anticipar c√≥mo un atacante podr√≠a intentar evadirlo. Este laboratorio refuerza la importancia de la visibilidad, la segmentaci√≥n y la respuesta activa ante anomal√≠as. La seguridad no es solo bloqueo, es tambi√©n observaci√≥n inteligente.</p>

  <h2>Disclaimer de advertencia</h2>
  <p>Este laboratorio ha sido dise√±ado exclusivamente con fines educativos y de formaci√≥n profesional en entornos controlados. Las t√©cnicas aqu√≠ descritas no deben ser utilizadas en redes reales, corporativas o p√∫blicas sin autorizaci√≥n expl√≠cita. El uso indebido de herramientas de escaneo, evasi√≥n o manipulaci√≥n de tr√°fico puede constituir una violaci√≥n legal grave. El autor y el proyecto El Pergamino Digital no se hacen responsables del uso inapropiado de este contenido. Toda pr√°ctica debe realizarse en entornos virtuales, aislados y con fines √©ticos.</p>

  <footer>
    <p>Este laboratorio forma parte del proyecto <strong><a href="https://pergamino-digital-ciberseguridad.blogspot.com/?m=1" target="_blank">El Pergamino Digital</a></strong>, una iniciativa t√©cnica, pedag√≥gica y certificadora.</p>
  </footer>

</body>
</html>
