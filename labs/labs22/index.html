<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Lab 22 ‚Äì Detecci√≥n de sistemas de prevenci√≥n de intrusos (IPS) y evasi√≥n b√°sica</title>
  <link rel="icon" href="/el-pergamino-digital/assets/favicon.png" type="image/png" />
  <style>
    :root { color-scheme: dark; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: #121212;
      color: #e0e0e0;
      margin: 0;
      padding: 2em;
      line-height: 1.6;
    }
    h1, h2 {
      color: #90caf9;
    }
    code {
      background-color: #1e1e1e;
      padding: 0.2em 0.4em;
      border-radius: 4px;
      font-family: Consolas, monospace;
    }
    pre {
      background-color: #1e1e1e;
      padding: 1em;
      border-radius: 6px;
      overflow-x: auto;
    }
    a {
      color: #90caf9;
    }
  </style>
</head>
<body>

  <h1>Lab 22 ‚Äì Detecci√≥n de sistemas de prevenci√≥n de intrusos (IPS) y evasi√≥n b√°sica</h1>
  <h2>Identificaci√≥n de IPS en red, an√°lisis de respuestas y aplicaci√≥n de t√©cnicas de evasi√≥n para evitar detecci√≥n</h2>

  <section>
    <h2>1. Objetivo</h2>
    <p>En entornos protegidos por sistemas de prevenci√≥n de intrusos (IPS), el reconocimiento activo tradicional puede ser detectado y bloqueado. Este laboratorio permite al analista ofensivo identificar la presencia de un IPS, analizar su comportamiento ante distintos patrones de tr√°fico y aplicar t√©cnicas evasivas para evitar su detecci√≥n. Comprender c√≥mo responde un IPS ante fragmentaci√≥n, manipulaci√≥n de TTL o inserci√≥n de datos aleatorios es esencial para avanzar hacia fases de explotaci√≥n sin activar alertas. Adem√°s, este conocimiento fortalece la capacidad de dise√±ar pruebas controladas y evaluar la eficacia de las defensas en entornos reales.</p>
  </section>

  <section>
    <h2>2. Nivel de dificultad</h2>
    <p>Intermedio</p>
  </section>

  <section>
    <h2>3. Herramientas utilizadas</h2>
    <ul>
      <li><code>nmap</code></li>
      <li><code>hping3</code></li>
      <li><code>fragroute</code></li>
      <li><code>Wireshark</code></li>
      <li><code>Snort</code> o <code>Suricata</code> (como IPS en entorno controlado)</li>
    </ul>
  </section>

  <section>
    <h2>4. Entorno de laboratorio</h2>
    <p>M√°quina atacante con Kali Linux, m√°quina v√≠ctima con un IPS activo (Snort o Suricata), red virtual controlada con capacidad de inspecci√≥n de tr√°fico.</p>
  </section>

  <section>
    <h2>5. Escenario</h2>
    <p>Un analista ofensivo necesita realizar reconocimiento en una red protegida por un IPS. El objetivo es identificar la presencia del sistema de prevenci√≥n, analizar su comportamiento y aplicar t√©cnicas evasivas para evitar ser detectado durante la fase de escaneo.</p>
  </section>

  <section>
    <h2>6. Pasos previos</h2>
    <ul>
      <li>Verificar conectividad entre atacante y v√≠ctima</li>
      <li>Instalar y configurar el IPS (Snort o Suricata) en la m√°quina v√≠ctima</li>
      <li>Actualizar reglas del IPS y activar el modo de prevenci√≥n</li>
      <li>Iniciar Wireshark en la m√°quina atacante para capturar tr√°fico</li>
    </ul>
  </section>

  <section>
    <h2>7. Desarrollo</h2>
    <ol>
      <li>Escaneo lento para evitar detecci√≥n por firmas:
        <pre><code>nmap -T1 -p 22,80,443 192.168.1.30</code></pre>
      </li>
      <li>Fragmentaci√≥n de paquetes para evadir inspecci√≥n:
        <pre><code>nmap -f -p 80,443 192.168.1.30</code></pre>
      </li>
      <li>Manipulaci√≥n de TTL para evitar sensores intermedios:
        <pre><code>nmap --ttl 5 -p 80,443 192.168.1.30</code></pre>
      </li>
      <li>Inserci√≥n de datos aleatorios en los paquetes:
        <pre><code>nmap --data-length 50 -p 80,443 192.168.1.30</code></pre>
      </li>
      <li>Env√≠o de paquetes con <code>hping3</code>:
        <pre><code>hping3 -S -p 80 --flood 192.168.1.30</code></pre>
      </li>
      <li>Captura y an√°lisis del tr√°fico con Wireshark</li>
    </ol>
  </section>

    <section>
    <h2>8. Resultados esperados</h2>
    <ul>
      <li>Detecci√≥n de respuestas an√≥malas o silencios ante t√©cnicas evasivas</li>
      <li>Identificaci√≥n de firmas activas del IPS</li>
      <li>Confirmaci√≥n de t√©cnicas que logran evadir la detecci√≥n</li>
      <li>Comparaci√≥n entre escaneos normales y modificados</li>
    </ul>
  </section>

  <section>
    <h2>9. An√°lisis de resultados</h2>
    <p>Los sistemas IPS analizan patrones de tr√°fico para detectar comportamientos sospechosos. T√©cnicas como la fragmentaci√≥n, manipulaci√≥n de TTL o inserci√≥n de datos aleatorios pueden evitar que el IPS detecte el escaneo. Comparar respuestas permite inferir qu√© mecanismos de defensa est√°n activos y c√≥mo adaptarse a ellos.</p>
  </section>

  <section>
    <h2>10. Conclusiones</h2>
    <p>Detectar la presencia de un IPS y comprender su comportamiento es esencial para planificar t√©cnicas de evasi√≥n efectivas. Las respuestas (o su ausencia) ante escaneos modificados permiten inferir qu√© mecanismos de defensa est√°n activos y c√≥mo adaptarse a ellos sin ser detectado.</p>
  </section>

  <section>
    <h2>11. Medidas</h2>
    <ul>
      <li>Registrar qu√© t√©cnicas activan alertas y cu√°les logran evadir el IPS</li>
      <li>Comparar respuestas entre escaneos normales y evasivos</li>
      <li>Documentar firmas detectadas y comportamiento del sistema de defensa</li>
    </ul>
  </section>

  <section>
    <h2>12. Contramedidas</h2>
    <ul>
      <li>Actualizar las firmas del IPS para detectar t√©cnicas de evasi√≥n conocidas</li>
      <li>Configurar umbrales de tr√°fico y alertas por comportamiento an√≥malo</li>
      <li>Implementar inspecci√≥n profunda de paquetes (DPI)</li>
      <li>Correlacionar eventos en SIEM para identificar patrones evasivos</li>
    </ul>
  </section>

  <section>
    <h2>13. Riesgos y advertencias</h2>
    <p>El uso de t√©cnicas de evasi√≥n puede activar contramedidas autom√°ticas como bloqueos, alertas o cuarentenas. Este laboratorio debe ejecutarse √∫nicamente en entornos controlados y con fines educativos. No aplicar en redes reales sin autorizaci√≥n expresa.</p>
  </section>

  <section>
    <h2>14. Evidencias</h2>
    <p><em>Espacio reservado para capturas de pantalla de Nmap, hping3, Wireshark, logs del IPS y comparativas de escaneos.</em></p>
  </section>

  <section>
    <h2>15. Validaci√≥n cruzada</h2>
    <ul>
      <li><a href="https://attack.mitre.org/techniques/T1595/002/" target="_blank">MITRE ATT&CK T1595.002 ‚Äì Active Scanning</a></li>
      <li><a href="https://attack.mitre.org/techniques/T1562/004/" target="_blank">MITRE ATT&CK T1562.004 ‚Äì Disable or Modify System Firewall/IPS</a></li>
      <li><a href="https://www.cisecurity.org/controls/network-monitoring-and-defense" target="_blank">CIS Control 13 ‚Äì Network Monitoring and Defense</a></li>
      <li><a href="https://csrc.nist.gov/publications/detail/sp/800-94/final" target="_blank">NIST SP 800-94 ‚Äì Guide to Intrusion Detection and Prevention Systems</a></li>
    </ul>
  </section>

  <section>
    <h2>16. Glosario asociado</h2>
    <ul>
      <li><strong>IPS:</strong> Sistema que detecta y bloquea tr√°fico malicioso en tiempo real.</li>
      <li><strong>TTL:</strong> Valor que limita la vida √∫til de un paquete en la red.</li>
      <li><strong>Fragmentaci√≥n:</strong> T√©cnica que divide un paquete para evadir detecci√≥n.</li>
      <li><strong>Firma:</strong> Patr√≥n que un IPS usa para identificar amenazas.</li>
      <li><strong>Escaneo evasivo:</strong> Reconocimiento dise√±ado para evitar detecci√≥n.</li>
    </ul>
  </section>

  <section>
    <h2>17. Preguntas de refuerzo</h2>
    <ol>
      <li>¬øQu√© diferencia hay entre un IDS y un IPS?</li>
      <li>¬øQu√© tipo de tr√°fico puede activar una firma en un IPS?</li>
      <li>¬øQu√© efecto tiene la fragmentaci√≥n de paquetes sobre la detecci√≥n?</li>
      <li>¬øC√≥mo puede manipularse el TTL para evadir sensores?</li>
      <li>¬øQu√© riesgos implica el uso de t√©cnicas evasivas en redes reales?</li>
    </ol>
  </section>

    <section>
    <h2>18. R√∫brica de evaluaci√≥n</h2>
    <ul>
      <li>‚úîÔ∏è Ejecuta correctamente t√©cnicas evasivas y captura evidencias</li>
      <li>‚úîÔ∏è Interpreta el comportamiento del IPS ante cada t√©cnica</li>
      <li>‚úîÔ∏è Relaciona t√©cnicas con est√°ndares y certificaciones</li>
      <li>‚úîÔ∏è Aplica medidas y contramedidas con criterio t√©cnico</li>
    </ul>
  </section>

  <section>
    <h2>19. Recursos complementarios</h2>
    <ul>
      <li><a href="https://nmap.org/book/man-bypass-firewalls-ids.html" target="_blank">Nmap Firewall/IDS Evasion Techniques</a></li>
      <li><a href="https://linux.die.net/man/8/fragroute" target="_blank">fragroute man page</a></li>
      <li><a href="https://www.snort.org/" target="_blank">Snort ‚Äì Open Source IPS</a></li>
      <li><a href="https://suricata.io/" target="_blank">Suricata ‚Äì Network Threat Detection Engine</a></li>
    </ul>
  </section>

  <section>
    <h2>20. Cr√©ditos y licencia</h2>
    <p>Este laboratorio forma parte del proyecto <a href="https://pergamino-digital-ciberseguridad.blogspot.com/?m=1" target="_blank">El Pergamino Digital</a>. Su uso est√° autorizado √∫nicamente con fines educativos, respetando la trazabilidad editorial y la licencia CC BY-NC-SA 4.0.</p>
  </section>

  <section>
    <h2>21. Nivel de certificaci√≥n</h2>
    <p>Intermedio ‚Äì Alineado con OSCP, Red Team Operator y eCPTX.</p>
  </section>

  <section>
    <h2>22. Mapa de integraci√≥n</h2>
    <ul>
      <li>üîó Relaci√≥n directa con el <strong>Lab 21</strong> (Fingerprinting de firewalls)</li>
      <li>üîú Prepara el terreno para el <strong>Lab 23</strong> (Bypass de WAF y evasi√≥n avanzada)</li>
      <li>üß™ Refuerza el dominio de t√©cnicas evasivas y an√°lisis de respuestas defensivas</li>
      <li>üéì Integra conceptos clave del simulador certificador: <em>Active Scanning</em>, <em>Defense Evasion</em>, <em>Network Monitoring</em></li>
    </ul>
  </section>

</body>
</html>
